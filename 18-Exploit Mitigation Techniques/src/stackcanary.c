//stackcanary.c
#include <stdio.h>

void auth_success()
{
    printf("Successfully authenticated\n");
}

void auth_fail()
{
    printf("Authentication failed, go away...\n");
}

int do_authenticate()
{
    char access_code[20];
    printf("Enter your access code: ");
    gets(access_code);

    return !strcmp(access_code, "trustno1");
}

void main()
{
    printf("Welcome user,");
    if (do_authenticate())
        auth_success();
    else
        auth_fail();
}