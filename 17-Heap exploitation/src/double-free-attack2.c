//double-free-attack2.c
#include <stdio.h>
#include <stdlib.h>

void main()
{
    int i;
    void *foo1, *foo2;
    
    foo1 = malloc(4);
    foo2 = malloc(4);
      
    free(foo1);
    free(foo2); //bypass fasttop
    free(foo1); //double free
    
    for (i=0; i<10; i++)
    {
      printf("malloc(4) -> %p\n", malloc(4));
    }
}