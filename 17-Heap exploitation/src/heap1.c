//heap1.c
#include <stdio.h>
#include <stdlib.h>

struct foo
{
    char name[12];
    void (*func_ptr)();
};

void print_message(struct foo *f)
{
    printf("Welcome %s\n", f->name);
    printf("No shell for you :(\n");
}

void backdoor()
{
    printf("Congrats, you've won\n");
    system("/bin/sh");
}

void main()
{
    setvbuf(stdout, NULL, _IONBF, 0);
    struct foo *f = malloc(sizeof(struct foo));
    f->func_ptr = print_message;

    printf("[?] Your name: ");
    gets(f->name);

    f->func_ptr(f);
}
