//stackcanary-bypass1.c
#include <stdio.h>
#include <stdlib.h>

void win()
{
    puts("You won, enjoy your shell");
    system("/bin/sh");
}

void vulnerable()
{
    char buffer1[64];
    char buffer2[64];

    puts("Enter something to echo:");
    fgets(buffer1, sizeof(buffer1), stdin);
    printf(buffer1);

    puts("Great, enter something else to echo:");
    read(0, buffer2, 128);
    puts(buffer2);    
}

void main()
{
    vulnerable();
}
